detected <- function(faces, others) {
  all <- c(faces, others)
  face <- sort(faces, decreasing = F)
  other <- sort(others, decreasing = F)
  all <- sort(all, decreasing = F)
  i <- 1
  j <- 1
  v <- c()
  for(k in 1:length(all)) {
    e <- 0
    if(k==1) {
      e <- 0
    } else {
      e <- v[k-1]
    }
    if(i<=length(faces)) {
      if(face[i]==all[k]) {
        i <- i+1
        e <- e + 1
      }
    }
    if(j<=length(others)) {
      if(other[j]==all[k]) {
        j <- j+1
        e <- e - 1
      }
    }
    
    v <- c(v, e)
  }
  return(v)
}
#Lukujen ja vektoreiden nimeäminen: Aluksi on ts eli testsize, jonka jälkeen on harjoituskuvien määrä.
#Sitten joko g tai r. G on eigenfacen generoinnin aika ja R on kasvojentunnistuksen aika.
#Tai vaihtoehtoisesti face tai other. Face on oikeiden kasvojen kasvojentunnistuksen arvoja ja other on satunnasiten ei-kasvo kuvien kasvojentunnistuksen arvoja.
#Tämän jälkeen on kuvan kannan pituus pikseleinä
#Eli ts100gtime25 tarkoittaa harjoitusdatan, jonka koko on 100 kuvaa, generointi aikaa, kun kuvan kanta on 25.
#Alla olevissa tunnistettavien kuvien määrä on 200.
#100 faces in training set
ts100gtime25 <- 1.05
ts100rtime25 <- 0.49
ts100face25 <- c(34.3501406958343, 40.44496160514582, 45.21981000031042, 38.28172887153943, 55.05455900419426, 29.53598905141538, 57.93436999314033, 51.125910980627594, 29.80171087739079, 41.94467453451151, 33.74987713157003, 26.48039796862094, 42.51034598183781, 54.057347193287576, 31.814321342639055, 49.20460168282271, 39.689807634393766, 45.54400529906675, 63.63220730982368, 40.650965707181705, 37.965244201290375, 52.31772625751168, 35.43631729084219, 57.42469758389323, 55.845514021547544, 51.3481040389582, 40.86143230809598, 48.13247637672797, 32.833413158297134, 39.611794971571996, 51.672649258472696, 36.67691115330588, 37.87423670598114, 30.355033091233917, 30.877810993939487, 31.270026708689585, 63.230905966151525, 42.32327759256311, 49.94526125990553, 47.29566512998651, 44.06116391714235, 33.74452597869421, 31.836875543297506, 47.58053418652957, 55.91414203469393, 38.96696477331286, 66.87198504283025, 37.834007795239515, 24.52403599951937, 27.763184214632606, 61.8653316412594, 76.0863704599279, 39.18326242499339, 42.654779310881324, 69.35937371092758, 49.4481278205543, 31.203607064522874, 47.932550543811, 78.50794595164164, 36.59230757370534, 38.15493804481693, 59.32889202055434, 46.34772328501595, 42.10403828092801, 50.36564561596165, 32.96648768071425, 38.5936869284987, 44.06832083328502, 38.24143865661437, 43.82675197366826, 66.7267464080032, 45.15916779655589, 59.76117280987482, 40.37315037280809, 40.25269926948237, 43.65760809320561, 34.08914927970994, 31.357549016894314, 53.4929380526099, 60.53835433846255, 30.132855310104837, 36.2270067626914, 65.78352511759773, 72.98704192077972, 69.22887464716727, 54.656141464607714, 40.81868602616857, 59.72073418903272, 39.661883090930644, 28.57982723999747, 59.931766946244025, 23.11207134289656, 35.51142805667125, 35.24208975917234, 45.00183235319856, 43.15673709258498, 32.70782228435899, 35.21971728673348, 36.49695682891089, 29.396042882203115)
ts100other25 <- c(78.53075785274767, 31.2099603674316, 46.04743601165546, 60.06852077643347, 61.98685096793032, 73.86971934275017, 29.34877560153668, 79.94383134385203, 37.19918939716022, 26.82109906640596, 73.78097481701225, 37.22231934058413, 90.06885016177226, 61.783646596258656, 37.830330664721735, 44.84037022528926, 60.765562508620626, 36.08648298595362, 61.475245162042576, 45.669270364288224, 27.081021615886435, 14.391989966680182, 55.64983219018002, 46.526613319735006, 43.79225307812586, 43.14068166072129, 33.95997620419881, 39.2567858351734, 82.82452453078449, 128.40853668274912, 70.7825229749699, 59.71529372545245, 85.96523601798866, 22.17691285124902, 50.65195985026656, 79.43797871847461, 78.67305923952277, 45.66124806523437, 45.18043008416491, 65.70282765582668, 77.74050461760879, 34.238777747651554, 21.50322621971743, 72.73910512770821, 45.811420991497315, 31.69636408575213, 92.33464422076888, 37.5939456053402, 65.86064185820855, 71.8344563264972, 55.8469694578711, 49.740358008804535, 66.37260893653834, 44.427109460739885, 78.01645932513578, 69.23865211092502, 26.63133553559915, 56.99956419139653, 52.993120311701816, 42.594555886536234, 40.98717313200855, 31.031747243489278, 54.9290419542446, 54.631687648243215, 162.53713198450328, 35.077261012221015, 145.80631961262296, 62.96007975758613, 63.61880083527296, 71.74563248215162, 74.20168318454152, 80.83040631520113, 34.142109854687746, 41.785985756809424, 33.80839901349998, 43.86707177832432, 69.7946358499017, 68.64251178083876, 45.47550219915017, 48.59443678030005, 56.771980699397794, 80.08520250722613, 75.44072135342375, 47.1464715971913, 14.602541313368752, 69.77262193562655, 76.64525106364584, 102.41374738259309, 42.13925428395855, 33.736399562912275, 118.59332698995779, 58.9754175288512, 45.243503051016106, 83.69427055522087, 39.53250386591358, 77.10215134331334, 34.53682986205199, 56.816178815992274, 45.34632846126971, 39.82831337513146)

ts100gtime50 <- 1.19
ts100rtime50 <- 0.67
ts100face50 <- c(33.78001951872954, 39.38528032662058, 45.473552722333736, 37.556070627235485, 54.29617927653009, 29.361599784162646, 58.48645048171108, 51.77643635176949, 28.31662699978191, 40.93783509388849, 32.66653991094107, 26.153627811520572, 42.586398052353125, 54.2147254596942, 30.554394916971464, 48.346006905880614, 40.68030397340073, 45.270216699811314, 63.69148677260306, 40.178726351756474, 37.93456865902827, 51.564848156933074, 35.171547058255555, 56.86408772887818, 55.30590028260197, 50.669302141367844, 40.4996511302114, 47.94443254772971, 32.24010717498532, 38.41835488338638, 51.05298943216575, 36.42509643585373, 37.63718835855737, 30.375961692545523, 29.9915608505828, 30.937904532089924, 63.32046843570873, 41.27267064255891, 50.03337083057513, 47.018515351201025, 44.75827538092298, 33.44516572233468, 31.615493036306887, 47.97325076686715, 56.80633263503172, 39.63072618333764, 65.71650017471431, 36.746917878200705, 24.602543648316868, 28.053590164222275, 61.9688528895589, 75.91965266080574, 37.74431086954492, 41.954428132980695, 69.75384160041018, 49.489043277913076, 30.79601347702878, 47.14416725671553, 76.83019917956304, 36.17338759811248, 37.46857747544856, 58.61697411499073, 46.69027214417616, 41.70913893991549, 50.429642266616604, 33.561553495060245, 37.18478040477582, 43.581261964806174, 37.96484822288794, 42.888976140643784, 63.94330095203493, 45.025804519353436, 60.25338314776835, 39.0446944568387, 40.28765731286241, 43.613852069920014, 32.75357404304799, 30.722870834948623, 53.625804721878794, 60.106253339578785, 30.096905042688427, 36.207126241622134, 65.25999638929171, 71.94269803227604, 70.2927599864307, 54.009654998818505, 40.34092765508106, 59.14491561884378, 39.499699768772444, 27.924807840129592, 59.925901422336885, 22.858934585669786, 35.85425952368513, 34.61346971495375, 44.25600205742193, 43.61873445503288, 31.189006780247464, 34.973765214033364, 34.531880512004804, 29.14325409954813)
ts100other50 <- c(78.31289738536337, 29.410333312900633, 45.12341983016804, 58.35365688720202, 61.36114476640319, 73.92130308570499, 27.788186252004238, 80.74364653240232, 36.496681776850544, 25.969402774412714, 73.874108145191, 37.18835030141513, 90.604963893216, 61.25284662829241, 36.9545034107329, 44.89343658721078, 59.28762455195894, 32.62304133709353, 60.60050704193084, 44.78084097214394, 26.629904083358767, 13.93093798030119, 55.217795868574, 46.41671969280859, 41.84298027310099, 35.458330198256505, 31.652948719834225, 39.07826019840324, 82.52000791991742, 128.32144423936361, 70.98266623934124, 60.092191559535735, 85.64563032750866, 20.286498483100466, 48.76401103879816, 79.6666854744626, 78.12513585255623, 43.9427379347111, 44.61520582940452, 65.64908134862901, 77.78521413228299, 35.57654772606828, 20.653833041458675, 72.76529697765208, 45.905996932139935, 30.596649332135204, 90.54959823568306, 37.021777995248094, 65.54861759501011, 72.65009236141482, 55.03511138313129, 50.124836880462055, 65.64340261760225, 44.31955222228254, 78.81036941952888, 68.74458049523254, 26.473954968975182, 56.308629434605045, 52.59357098060988, 40.478519620156646, 41.11493039025037, 30.90638297889486, 54.36786669150986, 51.064706150391046, 161.31612027936586, 30.87843049115083, 146.1365341765273, 62.84490542808823, 63.83947042560186, 71.87204757502398, 74.04452472306889, 77.01440793069958, 34.355147772567875, 38.652516677376404, 31.818752680696925, 42.50235131585273, 68.6219191443627, 68.57095945230668, 44.602742763488614, 47.32963301916627, 56.66167528510933, 79.96587797028359, 75.11419971115419, 47.0821985477198, 14.285628596125225, 69.85299208417014, 76.65734443597971, 101.54621271583865, 41.93495439136299, 33.608998813801485, 118.92748456608552, 58.57716161379988, 44.25180976276781, 83.6787137901222, 38.567277611444915, 77.29831442339051, 33.632019970407825, 53.8882905706246, 45.39358460443194, 39.589153201619425)

ts100gtime75 <- 1.36
ts100rtime75 <- 1.03
ts100face75 <- c(33.67575350657388, 39.85365735371628, 45.32684584423853, 37.61381174565204, 53.920881003308416, 29.362126615458973, 58.606393041791804, 51.23735919083521, 28.563018910596, 40.62991282706951, 33.39923895399002, 25.642021574861403, 42.27138739722168, 54.36065017923955, 30.42279774805114, 48.377980535579866, 40.38772337894654, 45.23470585148526, 63.55163646410115, 40.23762469729779, 37.79066757332464, 51.546114716035376, 35.135669925115536, 56.813597630276504, 55.56177360761313, 50.79469736384662, 40.34364629329494, 47.889429991009195, 32.060846307818096, 38.588414158152325, 50.95053381275365, 36.400418958818086, 37.664156791440625, 30.428942101014364, 29.797269435069655, 30.92625809740839, 63.074826409143824, 40.9013991027259, 49.883477072074804, 46.974799096903084, 44.377569611288024, 33.36114807184655, 31.418113633001905, 47.55549902127894, 56.23025623731507, 39.01890359255005, 66.23460903654359, 37.27315853770171, 24.770786525002233, 27.896913415819885, 61.8290362437, 75.96600850604746, 38.01727043493948, 42.01600311222337, 69.53359688016403, 49.788713034183516, 30.552857845149163, 46.982369977005895, 76.68973615265242, 36.06914306611165, 37.57702421143745, 58.20848745675105, 46.31383599701377, 41.93953072233755, 50.41399890444806, 33.187934977556054, 37.99256749225683, 43.9380682950591, 37.68871620802561, 43.07625815910407, 64.57030318987881, 45.26611444987123, 59.77472295517763, 39.19943819837268, 40.248432768504394, 43.51854910445997, 33.08348599170422, 30.413783794261047, 53.64840116491345, 60.129783113385336, 30.22295490586473, 36.22234080176463, 65.13204905312621, 72.14782186137914, 70.24211690484637, 54.013600791302125, 40.33106432781108, 58.922381140947074, 39.52298926814813, 28.05433362580362, 59.97404024845704, 22.647645017043743, 35.29134821668452, 34.36024241854117, 44.10067928589929, 43.43769292876523, 31.553120826579132, 35.077670227894686, 34.80823675849491, 28.676435365516863)
ts100other75 <- c(78.42166668706845, 29.15244737884391, 45.39390838468136, 59.0633925091959, 61.531174821146635, 73.92627050318359, 27.701961700184377, 80.23759652471608, 36.75767349167595, 26.15808316908621, 73.76766420661491, 37.21438730316814, 90.7905427904935, 61.638847852773104, 36.80939337677524, 44.69654744119428, 58.729191857878504, 32.599018249647585, 60.27034548860936, 44.87392993570449, 26.31191975797651, 14.090109239077528, 55.25867689440462, 46.37132818692342, 41.956104173216815, 36.027811736545154, 32.19796560202669, 39.027104824145766, 82.68443656035988, 127.82033970213912, 70.633165336466, 60.06992353959509, 85.89482068073217, 19.985316315065376, 49.08813158045814, 79.69412658489152, 78.37161668106224, 43.84127642233893, 44.62319245488243, 65.73588337262409, 77.82116750904116, 35.28431445531238, 20.92413516235474, 72.95791769282455, 45.89518949672431, 30.861487503791572, 91.38381482242794, 36.44708520643101, 65.22206651050374, 72.41683890542929, 54.95413561532618, 49.858192706272646, 65.16642397093209, 44.52230119336439, 78.51325361194732, 69.14726369820742, 26.172018489865334, 56.581808393427515, 52.418029574470204, 40.018815152553934, 41.13905511880525, 30.999788377974546, 54.38900786438943, 54.440201774115444, 161.49451286641897, 30.300896585609966, 145.84314788874858, 62.87959796342516, 63.78001965786995, 71.89768965014719, 74.25438016266213, 78.99847668796471, 34.278541465503395, 39.30753519769963, 32.173491052554716, 42.6373705799548, 68.40128533320309, 68.5896128529706, 44.04782816953041, 47.524973367119486, 56.72031551720936, 79.84102031729402, 74.82643792355384, 47.12283194167356, 14.31945312634345, 69.89732700444766, 76.737050937912, 101.36240189797863, 41.87395481050649, 33.46423039549848, 119.35505787510965, 59.23971467670348, 44.120541056751044, 83.71888470604979, 38.730342079853145, 77.15675689876862, 33.68905327742875, 54.47018000344316, 45.32900463496322, 39.46159722859261)

ts100gtime100 <- 1.66
ts100rtime100 <- 1.66
ts100face100 <- c(33.42950672172654, 39.62265456044431, 45.2822996660178, 37.63681797483889, 53.86520346561926, 29.13539638249657, 58.89975589592343, 51.30915878783745, 28.151326452762596, 40.72128326179273, 32.978251684610264, 25.789217467331024, 42.403230129889565, 54.55280023635764, 30.14681655008703, 48.49160149901786, 40.41774953707667, 45.09397830653122, 63.46920283184171, 40.18093038831254, 37.93407879077615, 51.51868871432432, 35.105018345419765, 56.61550704943821, 55.52123603891716, 50.86295072792917, 40.36808840403441, 47.94805521724616, 32.03526701219842, 38.600211396415006, 51.028635032955755, 36.28914951147235, 37.59976575613459, 30.349386245014426, 29.87922882093994, 30.834631989680428, 63.15979862789345, 40.972165099348686, 49.817427821998216, 46.998007198394795, 44.606262761365834, 33.46568702934827, 31.921390970268817, 47.59292941259574, 56.36081548054659, 39.05859806744048, 66.22589175707927, 37.47752779873639, 24.546099976538336, 27.720185813801653, 61.63062511876212, 76.02141978647255, 37.95171473429883, 41.92469915682655, 69.46222804202172, 50.06191853145077, 30.767930437867157, 46.64901956738922, 76.64305648228574, 36.187297744419816, 37.86101594885287, 58.0899939820954, 46.49599106108518, 41.56008420347178, 50.33673499771404, 33.119986781696824, 38.235012319479836, 44.22457251514986, 37.96083978959722, 42.969067145684306, 64.5623357433597, 45.28221925867336, 59.80524997484826, 39.55853242294388, 40.31283310916256, 43.5723738105139, 33.232468230956115, 30.535492366317445, 53.75843531526552, 60.31452732752655, 30.27922489059166, 36.36594471184173, 65.47956131176495, 71.85880226130818, 70.04188003515132, 54.25853808540156, 40.28675654398904, 59.08310798049966, 39.535268798985506, 27.92272270034248, 60.095272526832524, 22.486921941944278, 35.33456953687913, 34.69039066389851, 44.53052276672875, 43.44244896536058, 31.46535180017145, 34.97751930478123, 34.310910612804356, 28.68387418090815)
ts100other100 <- c(78.43450064844318, 28.219344935763484, 45.617207341931596, 58.32762706580678, 61.29474303796392, 73.88920738582287, 27.537009125510217, 80.66449879279062, 36.71866506786523, 26.09792877141594, 73.8009653059248, 36.91985808794361, 90.89540529388354, 61.22967345016009, 36.965273356504184, 44.830204253469404, 58.204475073731025, 32.88873765903802, 60.54481260897146, 44.784885592678364, 26.273291882173854, 13.975205927818267, 55.28928619869064, 46.500976638655786, 39.51679362811987, 36.00026036801682, 32.05710438082317, 39.10407157163059, 82.6749819465377, 127.92327607814343, 70.81128410909537, 59.98227836689017, 85.78623551589577, 20.589637741394903, 48.84432019294264, 79.69946283921175, 78.36039114321449, 43.740939072590315, 44.43077839329416, 65.68338455020546, 77.81340054076189, 34.44025250977056, 20.669956144698887, 72.96023591443505, 45.839294914492996, 30.474598325882837, 91.415541025902, 36.92104494642664, 65.50259116880258, 72.47015639342087, 55.21037198633358, 49.907199119710874, 65.100223438519, 44.45495249193057, 78.21933430179675, 69.14232321912124, 26.166841405958806, 56.81965903874424, 52.71490255024963, 40.150577499705435, 41.17214585334114, 31.061915052697042, 54.5347280927076, 50.928487716091176, 161.44742884720486, 29.904241783743238, 145.70823500398535, 62.840937394600296, 63.823262604259895, 72.04649070865227, 74.35199283704019, 77.81777993867328, 34.31309444376572, 38.84199160645939, 31.563280462511933, 42.32860232873528, 68.68682130681724, 68.65521650284238, 44.47144166392443, 47.32785652652583, 56.571053225540936, 79.91390372621373, 73.72598750526814, 47.05833608912458, 14.444088367137745, 69.86550021199857, 76.634842030348, 101.070896022507, 41.83508118008015, 33.467694484911334, 117.44871700223106, 58.9368919058352, 44.114455941011784, 83.6335313411047, 38.6415532155261, 77.05501276478616, 33.685639363052644, 54.44094548375171, 45.32243801606692, 39.470726037374966)

#200 faces in training set
ts200gtime25 <- 7.33
ts200rtime25 <- 0.47

ts200gtime50 <- 7.96
ts200rtime50 <- 0.813215

ts200gtime75 <- 8.73
ts200rtime75 <- 1.46

ts200gtime100 <- 10.17
ts200rtime100 <- 2.71

#400 faces in training set
ts400gtime25 <- 84.14
ts400rtime25 <- 0.51

ts400gtime50 <- 89.14
ts400rtime50 <- 1.05

ts400gtime75 <- 92.29
ts400rtime75 <- 2.57

ts400gtime100 <- 106.71
ts400rtime100 <- 4.58
#Kasvojentunnistukseen kulunutaika eri tunnistettavien kasvojen määrällä.
#FacialRecognition
ts100rtimeFaceAmount50 <-  0.71
ts100rtimeFaceAmount100 <- 0.84 
ts100rtimeFaceAmount200 <- 1.66
ts100rtimeFaceAmount400 <- 3.43
  
  
detected25 <- detected(ts100face25, ts100other25)
sorted25 <- sort(c(ts100face25, ts100other25))
max25 <- sorted25[which(detected25==max(detected25))]
print(max(max25))

detected50 <- detected(ts100face50, ts100other50)
sorted50 <- sort(c(ts100face50, ts100other50))
max50 <- sorted50[which(detected50==max(detected50))]
print(max(max50))

detected75 <- detected(ts100face75, ts100other75)
sorted75 <- sort(c(ts100face75, ts100other75))
max75 <- sorted75[which(detected75==max(detected75))]
print(max(max75))


detected100 <- detected(ts100face100, ts100other100)
sorted100 <- sort(c(ts100face100, ts100other100))
max100 <- sorted100[which(detected100==max(detected100))]
print(max(max100))

plot(sort(c(ts100face50, ts100other50)), detected(ts100face50, ts100other50), main="Harjoituskuvien määrä: 100, Kuvien kanta: 50", xlab="Kuvien painovektorein etäisyys harjoitusdatan painovektoreista", ylab="Tunnistettujen kasvojen pisteet")
plot(sort(c(ts100face75, ts100other75)), detected(ts100face75, ts100other75), main="Harjoituskuvien määrä: 100, Kuvien kanta: 75", xlab="Kuvien painovektorein etäisyys harjoitusdatan painovektoreista", ylab="Tunnistettujen kasvojen pisteet")
plot(sort(c(ts100face100, ts100other100)), detected(ts100face100, ts100other100), main="Harjoituskuvien määrä: 100, Kuvien kanta: 100", xlab="Kuvien painovektorein etäisyys harjoitusdatan painovektoreista", ylab="Tunnistettujen kasvojen pisteet")

